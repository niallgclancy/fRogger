(661+627)/(661+627+113+147)
661/(661+113)
627/(627+147)
frog = subset(frog, frog$Latitude<=49)#only modelling in United States-->remove canadian samples
#Actual sites too warm
frog$TooWarm2080=NA
frog$TooWarm2080[which(frog$S32_2080D>12)]="WARM"
frog$TooWarm2080[which(frog$S32_2080D<=12)]="REFUGIA"
frog%>%
group_by(TooWarm2080)%>%
summarise (n = length(slope))
frog$TooWarm2080[which(frog$S32_2080D>14)]="ExceedCTM"
frog$TooWarm2080[which(frog$S32_2080D<=12)]="REFUGIA"
frog%>%
group_by(TooWarm2080)%>%
summarise (n = length(slope))
#Actual sites too warm
frog$TooWarm2080=NA
frog$TooWarm2080[which(frog$S32_2080D>12)]="WARM"
frog$TooWarm2080[which(frog$S32_2080D>14)]="ExceedCTM"
frog$TooWarm2080[which(frog$S32_2080D<=12)]="REFUGIA"
frog%>%
group_by(TooWarm2080)%>%
summarise (n = length(slope))
873/(873+1496+1486)
#Canada Actual sites too warm
frogBC=read.csv("CANADA_ONLY.csv")
frogBC$TooWarm2080=NA
frogBC$TooWarm2080[which(frogBC$S32_2080D>12)]="WARM"
frogBC$TooWarm2080[which(frogBC$S32_2080D>14)]="ExceedCTM"
frogBC$TooWarm2080[which(frogBC$S32_2080D<=12)]="REFUGIA"
frogBC%>%
group_by(TooWarm2080)%>%
summarise (n = length(slope))
View(frogBC)
#Canada Actual sites too warm
frogBC=read.csv("CANADA_ONLY.csv")
frogBC$TooWarm2080=NA
frogBC$TooWarm2080[which(frogBC$TEMP_2080_RCP6>12)]="WARM"
frogBC$TooWarm2080[which(frogBC$TEMP_2080_RCP6>14)]="ExceedCTM"
frogBC$TooWarm2080[which(frogBC$TEMP_2080_RCP6<=12)]="REFUGIA"
frogBC%>%
group_by(TooWarm2080)%>%
summarise (n = length(Common_Nam))
both <- read_excel("MasterAmphibWithTemps.xlsx")
frog = subset(both, both$Common_Nam=="Rocky Mountain Tailed Frog")
#write.csv(frog, "MasterAmphibWithTemps.csv")
frog = subset(frog, frog$Latitude<=49)#only modelling in United States-->remove canadian samples
frog%>%group_by(Data_Sourc)%>%summarise(n=length(slope))
frogBC%>%group_by(Data_Sourc)%>%summarise(n=length(Common_Nam))
15+6+1
frog%>%
group_by(TooWarm2080)%>%
summarise (n = length(slope))
#USA Actual sites too warm
frog$TooWarm2080=NA
frog$TooWarm2080[which(frog$S32_2080D>12)]="WARM"
frog$TooWarm2080[which(frog$S32_2080D>14)]="ExceedCTM"
frog$TooWarm2080[which(frog$S32_2080D<=12)]="REFUGIA"
frog%>%
group_by(TooWarm2080)%>%
summarise (n = length(slope))
1496/3855
873/3855
frogBC%>%
group_by(TooWarm2080)%>%
summarise (n = length(Common_Nam))
9/22
3855+22
1496/3877
1-0.3858654
#2080s
sdm%>%filter(occ==1)%>%
group_by(S32_2080D>12)%>%
summarise(n=length(slope)) #65.6% too warm to be refugia
40670+21279
40670/61949
#USA Actual sites too warm
frog$TooWarm2080=NA
frog$TooWarm2080[which(frog$S32_2080D>12)]="WARM"
frog$TooWarm2080[which(frog$S32_2080D>14)]="ExceedCTM"
frog$TooWarm2080[which(frog$S32_2080D<=12)]="CWH"
frog%>%
group_by(TooWarm2080)%>%
summarise (n = length(slope))
#USA Historical
frog$TooWarmHIST=NA
frog$TooWarmHIST[which(frog$S1_93_11>12)]="WARM"
frog$TooWarmHIST[which(frog$S1_93_11<=12)]="CWH"
#USA Historical
frog$TooWarmHIST=NA
frog$TooWarmHIST[which(frog$S1_93_11>12)]="WARM"
frog$TooWarmHIST[which(frog$S1_93_11<=12)]="CWH"
frog%>%
group_by(TooWarmHIST)%>%
summarise (n = length(slope))
3140/3855
#USA Actual sites too warm
frog$TooWarm2080=NA
frog$TooWarm2080[which(frog$S32_2080D>12)]="WARM"
frog$TooWarm2080[which(frog$S32_2080D>14)]="ExceedCTM"
frog$TooWarm2080[which(frog$S32_2080D<=12)]="CWH"
frog%>%
group_by(TooWarm2080)%>%
summarise (n = length(slope))
1496/3855
1496/3140
#Canada Actual sites too warm
frogBC=read.csv("CANADA_ONLY.csv")
frogBC$TooWarm2080=NA
frogBC$TooWarm2080[which(frogBC$TEMP_2080_RCP6>12)]="WARM"
frogBC$TooWarm2080[which(frogBC$TEMP_2080_RCP6>14)]="ExceedCTM"
frogBC$TooWarm2080[which(frogBC$TEMP_2080_RCP6<=12)]="REFUGIA"
frogBC%>%
group_by(TooWarm2080)%>%
summarise (n = length(Common_Nam))
#CAanadaHistorical
frogBC$TooWarmHIST=NA
frogBC$TooWarmHIST[which(frogBC$S1_93_11>12)]="WARM"
frogBC$TooWarmHIST[which(frogBC$S1_93_11<=12)]="CWH"
frogBC%>%
group_by(TooWarmHIST)%>%
summarise (n = length(slope))
#USA Actual sites too warm @13
frog$TooWarm2080=NA
frog$TooWarm2080[which(frog$S32_2080D>13)]="WARM"
frog$TooWarm2080[which(frog$S32_2080D<=13)]="CWH"
frog%>%
group_by(TooWarm2080)%>%
summarise (n = length(slope))
1511/3855
#USA Actual sites too warm
frog$TooWarm2080=NA
frog$TooWarm2080[which(frog$S32_2080D>13)]="TOO WARM"
frog$TooWarm2080[which(frog$S32_2080D>12 & frog$S32_2080D>13)]="margCWH"
frog$TooWarm2080[which(frog$S32_2080D<=12)]="CWH"
frog%>%
group_by(TooWarm2080)%>%
summarise (n = length(slope))
#USA Actual sites too warm
frog$TooWarm2080=NA
frog$TooWarm2080[which(frog$S32_2080D>13)]="TOO WARM"
#USA Actual sites too warm
frog$TooWarm2080=NA
frog$TooWarm2080[which(frog$S32_2080D>=13)]="TOO WARM"
frog$TooWarm2080[which(frog$S32_2080D>12 & frog$S32_2080D<13)]="margCWH"
frog$TooWarm2080[which(frog$S32_2080D<=12)]="CWH"
frog%>%
group_by(TooWarm2080)%>%
summarise (n = length(slope))
frog%>%
group_by(TooWarm2080)%>%
summarise (n = length(slope)/3855)
#USA Historical
frog$TooWarmHIST=NA
frog$TooWarmHIST[which(frog$S1_93_11>=12)]="TOO WARM"
frog$TooWarmHIST[which(frog$S1_93_11>12 & frog$S1_93_11<13)]="margCWH"
frog$TooWarmHIST[which(frog$S1_93_11<=12)]="CWH"
frog%>%
group_by(TooWarmHIST)%>%
summarise (n = length(slope))
frog%>%
group_by(TooWarmHIST)%>%
summarise (n = length(slope)/3855)
twh=frog%>%filter(TooWarmHIST=="TOO WARM")
View(twh)
twh_JA=twh%>%filter(M==8 | M==7)
199/301
301-199
102/301
ntwh=frog%>%filter(TooWarmHIST!="TOO WARM")
ntwh_JA=ntwh%>%filter(M==8 | M==7)
3554-2850
704/3554
frog%>%
group_by(TooWarmHIST)%>%
summarise (n = length(slope))
#USA Historical
frog$TooWarmHIST=NA
frog$TooWarmHIST[which(frog$S1_93_11>=12)]="TOO WARM"
frog$TooWarmHIST[which(frog$S1_93_11>12 & frog$S1_93_11<13)]="margCWH"
frog$TooWarmHIST[which(frog$S1_93_11<=12)]="CWH"
frog%>%
group_by(TooWarmHIST)%>%
summarise (n = length(slope),p = length(slope)/3855)
#USA Actual sites too warm
frog$TooWarm2080=NA
frog$TooWarm2080[which(frog$S32_2080D>=13)]="TOO WARM"
frog$TooWarm2080[which(frog$S32_2080D>12 & frog$S32_2080D<13)]="margCWH"
frog$TooWarm2080[which(frog$S32_2080D<=12)]="CWH"
frog%>%
group_by(TooWarm2080)%>%
summarise (n = length(slope),p = length(slope)/3855)
#Canada Actual sites too warm
frogBC=read.csv("CANADA_ONLY.csv")
frogBC$TooWarm2080=NA
frogBC$TooWarm2080[which(frogBC$S32_2080D>=13)]="TOO WARM"
frogBC$TooWarm2080[which(frogBC$S32_2080D>12 & frogBC$S32_2080D<13)]="margCWH"
frogBC$TooWarm2080[which(frogBC$S32_2080D<=12)]="CWH"
frogBC%>%
group_by(TooWarm2080)%>%
summarise (n = length(Common_Nam), p=length(Common_Nam)/22)
#Canada Actual sites too warm
frogBC=read.csv("CANADA_ONLY.csv")
frogBC$TooWarm2080=NA
frogBC$TooWarm2080[which(frogBC$S32_2080D>=13)]="TOO WARM"
frogBC$TooWarm2080[which(frogBC$S32_2080D>12 & frogBC$S32_2080D<13)]="margCWH"
frogBC$TooWarm2080[which(frogBC$S32_2080D<=12)]="CWH"
frogBC%>%
group_by(TooWarm2080)%>%
summarise (n = length(Common_Nam), p=length(Common_Nam)/22)
frogBC$TooWarm2080=NA
frogBC$TooWarm2080[which(frogBC$TEMP_2080_RCP6>=13)]="TOO WARM"
frogBC$TooWarm2080[which(frogBC$TEMP_2080_RCP6>12 & frogBC$TEMP_2080_RCP6<13)]="margCWH"
frogBC$TooWarm2080[which(frogBC$TEMP_2080_RCP6<=12)]="CWH"
frogBC%>%
group_by(TooWarm2080)%>%
summarise (n = length(Common_Nam), p=length(Common_Nam)/22)
View(sdm)
################################Look at loss and refugia
sdm$TooWarm2080[which(sdm$S32_2080D>=13)]="TOO WARM"
sdm$TooWarm2080[which(sdm$S32_2080D>12 & sdm$S32_2080D<13)]="margCWH"
sdm$TooWarm2080[which(sdm$S32_2080D<=12)]="CWH"
################################Look at loss and refugia
sdm$TooWarm2080=NA
sd$TooWarmHIST=NA
sdm$TooWarm2080[which(sdm$S32_2080D>=13)]="TOO WARM"
sdm$TooWarm2080[which(sdm$S32_2080D>12 & sdm$S32_2080D<13)]="margCWH"
sdm$TooWarm2080[which(sdm$S32_2080D<=12)]="CWH"
sdm$TooWarmHIST[which(sdm$TEMP>=12)]="TOO WARM"
sdm$TooWarmHIST[which(sdm$TEMP>12 & sdm$TEMP<13)]="margCWH"
sdm$TooWarmHIST[which(sdm$TEMP<=12)]="CWH"
################################Look at loss and refugia
sdm$TooWarm2080=NA
sdm$TooWarmHIST=NA
sdm$TooWarm2080[which(sdm$S32_2080D>=13)]="TOO WARM"
sdm$TooWarm2080[which(sdm$S32_2080D>12 & sdm$S32_2080D<13)]="margCWH"
sdm$TooWarm2080[which(sdm$S32_2080D<=12)]="CWH"
sdm$TooWarmHIST[which(sdm$TEMP>=12)]="TOO WARM"
sdm$TooWarmHIST[which(sdm$TEMP>12 & sdm$TEMP<13)]="margCWH"
sdm$TooWarmHIST[which(sdm$TEMP<=12)]="CWH"
#Current
sdm%>%filter(occ==1)%>%
group_by(TooWarmHIST)%>%
summarise(n=length(slope)) #19.1% too warm to be refugia
50120+4105+7724
#2040s
sdm%>%filter(occ==1)%>%
group_by(TooWarm2080)%>%
summarise(n=length(slope), p=length(slope)/61949) #45.7% too warm to be refugia
#Current
sdm%>%filter(occ==1)%>%
group_by(TooWarmHIST)%>%
summarise(n=length(slope), p=length(slope)/61949) #19.1% too warm to be refugia
#2040s
sdm%>%filter(occ==1)%>%
group_by(TooWarm2080)%>%
summarise(n=length(slope), p=length(slope)/61949) #45.7% too warm to be refugia
80.9+6.6+12.5
#USA Actual sites too warm
frog$TooWarm2080=NA
frog$TooWarm2080[which(frog$S32_2080D>=13)]="TOO WARM"
frog$TooWarm2080[which(frog$S32_2080D>12 & frog$S32_2080D<13)]="margCWH"
frog$TooWarm2080[which(frog$S32_2080D<=12)]="CWH"
frog%>%
group_by(TooWarm2080)%>%
summarise (n = length(slope),p = length(slope)/3855)
40.8+20.4
################################Look at loss and refugia
sdm$TooWarm2080=NA
sdm$TooWarmHIST=NA
sdm$TooWarm2080[which(sdm$S32_2080D>=13)]="TOO WARM"
sdm$TooWarm2080[which(sdm$S32_2080D>12 & sdm$S32_2080D<13)]="margCWH"
sdm$TooWarm2080[which(sdm$S32_2080D<=12)]="CWH"
sdm$TooWarmHIST[which(sdm$TEMP>=12)]="TOO WARM"
sdm$TooWarmHIST[which(sdm$TEMP>12 & sdm$TEMP<13)]="margCWH"
sdm$TooWarmHIST[which(sdm$TEMP<=12)]="CWH"
#Current
sdm%>%filter(occ==1)%>%
group_by(TooWarmHIST)%>%
summarise(n=length(slope), p=length(slope)/61949) #
#2080s
sdm%>%filter(occ==1)%>%
group_by(TooWarm2080)%>%
summarise(n=length(slope), p=length(slope)/61949) #45.7% too warm to be refugia
44.2+21.4
#Canada Actual sites too warm
frogBC=read.csv("CANADA_ONLY.csv")
frogBC$TooWarm2080=NA
frogBC$TooWarm2080[which(frogBC$TEMP_2080_RCP6>=13)]="TOO WARM"
frogBC$TooWarm2080[which(frogBC$TEMP_2080_RCP6>12 & frogBC$TEMP_2080_RCP6<13)]="margCWH"
frogBC$TooWarm2080[which(frogBC$TEMP_2080_RCP6<=12)]="CWH"
frogBC%>%
group_by(TooWarm2080)%>%
summarise (n = length(Common_Nam), p=length(Common_Nam)/22)
sdm$TooWarm2040=NA
sdm$TooWarm2040[which(sdm$S30_2040D>=13)]="TOO WARM"
sdm$TooWarm2040[which(sdm$S30_2040D>12 & sdm$S30_2040D<13)]="margCWH"
sdm$TooWarm2040[which(sdm$S30_2040D<=12)]="CWH"
frog.B%>%
ggplot(aes(x=S1_93_11, y=present))+
geom_smooth(method = glm, method.args= list(family="binomial"))+
geom_hline(yintercept = 0.5)+
geom_vline(xintercept = 11.2)
#2040s
sdm%>%filter(occ==1)%>%
group_by(TooWarm2040)%>%
summarise(n=length(slope), p=length(slope)/61949)
#Load packages
library(randomForest)
library(readxl)
library(dplyr)
library(tidyr)
library(ggplot2)
library(evaluate)
library(pROC)
View(sdm)
View(frog.all)
predictors = frog.all[,c(8,16,17,18,19,20,78,79,21,22,12)]
predictors$occ = NA
predictors$occ=predict(frog.rf, predictors[,c(1:6)])
##########LOOK AT PREDICTION ACCURACY on VALIDATION DATASET (TEST)
test=test%>%rename(TEMP=S1_93_11)
test$rf.predicted=predict(frog.rf, test[,c(3:8)])
test$rf.predicted=as.numeric(as.character(test$rf.predicted))
test_roc <- roc(test$present, test$rf.predicted)
auc(test_roc)#0.832 nice
test%>%
group_by(present, rf.predicted)%>%
summarise(n=length(slope))
#limit entire SDM network with super steep slopes (>16% as suggested by Isaak et al. 2025 NAJFM)
sdm=predictors%>%filter(slope<0.16)
write.csv(sdm, file = "frog_sdm.csv")
predictors = frog.all[,c(8,16,17,18,19,20,78,79,21,22,12)]
#You will need to unzip this file first
#Load 1 km points across all streams in RMTF range
frog.all = read.csv("Frog_allpoints.csv")
#Clean points
frog.all = subset(frog.all, frog.all$feature_y<=49)#remove random location in Canada
frog.all=subset(frog.all,frog.all$S1_93_11>=0 & frog.all$BFI>=0)
duplicated(frog.all$OBSPRED_ID)
frog.all= frog.all[,c(8,16,17,18,19,20,78,79,21,22,12)]
frog.all= frog.all[,c(8,16,17,18,19,20,78,79,21,22,12)]
#You will need to unzip this file first
#Load 1 km points across all streams in RMTF range
frog.all = read.csv("Frog_allpoints.csv")
#Clean points
frog.all = subset(frog.all, frog.all$feature_y<=49)#remove random location in Canada
frog.all=subset(frog.all,frog.all$S1_93_11>=0 & frog.all$BFI>=0)
frog.all = frog.all[,c(8,16,17,18,19,20,78,79,21,22,12)]
#You will need to unzip this file first
#Load 1 km points across all streams in RMTF range
frog.all = read.csv("Frog_allpoints.csv")
#Clean points
frog.all = subset(frog.all, frog.all$feature_y<=49)#remove random location in Canada
frog.all=subset(frog.all,frog.all$S1_93_11>=0 & frog.all$BFI>=0)
frog.all = frog.all[,c(13,9,21,17,18,19,20,22,23,77,78)]
frog.all%>%
group_by(OBSPRED_ID)%>%
summarise(SLOPE=mean(slope), elev=mean(ELEV), canopy=mean(CANOPY), precip=mean(PRECIP), bfi=mean(BFI),S1=mean(S1_93_11), S30=mean(S30_2040D), S32=mean(S32_2080D), x=mean(feature_x), y=mean(feature_y))
frog.all=frog.all%>%
group_by(OBSPRED_ID)%>%
summarise(SLOPE=mean(slope), elev=mean(ELEV), canopy=mean(CANOPY), precip=mean(PRECIP), bfi=mean(BFI),S1=mean(S1_93_11), S30=mean(S30_2040D), S32=mean(S32_2080D), x=mean(feature_x), y=mean(feature_y))
frog.all%>%rename(slope=SLOPE, ELEV=elev, CANOPY=canopy, PRECIP=precip, BFI=bfi, S1_93_11=S1, S30_2040D=S30, S32_2080D=S32)
fog.all=frog.all%>%rename(slope=SLOPE, ELEV=elev, CANOPY=canopy, PRECIP=precip, BFI=bfi, S1_93_11=S1, S30_2040D=S30, S32_2080D=S32)
#Randomly select pseudo absences and merge dataframes of observations and pseudo-absences
rand_df <- frog.all[sample(nrow(frog.all), size=3855), ]
frog.A = frog[,c(8,9,12,20:26)]
colnames(frog.A)
names(rand_df)[names(rand_df) == "y"] <- "Latitude"
names(rand_df)[names(rand_df) == "x"] <- "Longitude"
frog.A$present = NA
frog.A$present = 1
rand_df$present = NA
rand_df$present = 0
frog.B = rbind(frog.A, rand_df)
colnames(rand_df)
frog.all=frog.all%>%rename(slope=SLOPE, ELEV=elev, CANOPY=canopy, PRECIP=precip, BFI=bfi, S1_93_11=S1, S30_2040D=S30, S32_2080D=S32)
#Randomly select pseudo absences and merge dataframes of observations and pseudo-absences
rand_df <- frog.all[sample(nrow(frog.all), size=3855), ]
rand_df$OBSPRED_ID=NULL
frog.all = read.csv("Frog_allpoints.csv")
#Clean points
frog.all = subset(frog.all, frog.all$feature_y<=49)#remove random location in Canada
frog.all=subset(frog.all,frog.all$S1_93_11>=0 & frog.all$BFI>=0)
frog.all = frog.all[,c(13,9,21,17,18,19,20,22,23,77,78)]
#merge duplicated points (same as spatial dissolve)
frog.all=frog.all%>%
group_by(OBSPRED_ID)%>%
summarise(SLOPE=mean(slope), elev=mean(ELEV), canopy=mean(CANOPY), precip=mean(PRECIP), bfi=mean(BFI),S1=mean(S1_93_11), S30=mean(S30_2040D), S32=mean(S32_2080D), x=mean(feature_x), y=mean(feature_y))
frog.all=frog.all%>%rename(slope=SLOPE, ELEV=elev, CANOPY=canopy, PRECIP=precip, BFI=bfi, S1_93_11=S1, S30_2040D=S30, S32_2080D=S32)
#Randomly select pseudo absences and merge dataframes of observations and pseudo-absences
rand_df <- frog.all[sample(nrow(frog.all), size=3855), ]
frog.A = frog[,c(8,9,12,20:26)]
names(rand_df)[names(rand_df) == "feature_y"] <- "Latitude"
names(rand_df)[names(rand_df) == "feature_x"] <- "Longitude"
names(rand_df)[names(rand_df) == "y"] <- "Latitude"
names(rand_df)[names(rand_df) == "x"] <- "Longitude"
frog.A$present = NA
frog.A$present = 1
rand_df$present = NA
rand_df$present = 0
frog.B = rbind(frog.A, rand_df)
rand_df$OBSPRED_ID=NULL
rand_df$present=NULL
#Randomly select pseudo absences and merge dataframes of observations and pseudo-absences
rand_df <- frog.all[sample(nrow(frog.all), size=3855), ]
frog.A = frog[,c(8,9,12,20:26)]
names(rand_df)[names(rand_df) == "y"] <- "Latitude"
names(rand_df)[names(rand_df) == "x"] <- "Longitude"
rand_df$OBSPRED_ID=NULL
rand_df$present=NULL
frog.A$present = NA
frog.A$present = 1
rand_df$present = NA
rand_df$present = 0
frog.B = rbind(frog.A, rand_df)
###########################Split into training and validation sets
fset <- sample(seq(1, 2), size = nrow(frog.B), replace = T, prob = c(.8, .2))
train <- frog.B[fset == 1,]
test <- frog.B[fset == 2,]
train=as.data.frame(train)
test=as.data.frame(test)
#RandomForest - classification
###create variables
occ = as.factor(train$present)
slope = train$slope
TEMP = train$S1_93_11
ELEV = train$ELEV
CANOPY = train$CANOPY
PRECIP = train$PRECIP
BFI = train$BFI
model = occ~slope+TEMP+ELEV+CANOPY+PRECIP+BFI
frog.rf = randomForest(model)
eval.rf = eval(frog.rf)
eval.rf
varImpPlot(frog.rf)
frog.all=frog.all%>%rename(TEMP=S1_93_11)
predictors = frog.all
predictors$occ = NA
predictors = frog.all[,c(2:7,1,8:11)]
predictors$occ = NA
predictors$occ=predict(frog.rf, predictors[,c(1:6)])
##########LOOK AT PREDICTION ACCURACY on VALIDATION DATASET (TEST)
test=test%>%rename(TEMP=S1_93_11)
test$rf.predicted=NA
test$rf.predicted=predict(frog.rf, test[,c(3:8)])
test$rf.predicted=as.numeric(as.character(test$rf.predicted))
test_roc <- roc(test$present, test$rf.predicted)
auc(test_roc)#0.832 nice
test%>%
group_by(present, rf.predicted)%>%
summarise(n=length(slope))
(693+688)/(693+688+62+103)
693/(693+62)
688/(688+103)
#limit entire SDM network with super steep slopes (>16% as suggested by Isaak et al. 2025 NAJFM)
sdm=predictors%>%filter(slope<0.16)
write.csv(sdm, file = "frog_sdm.csv")
################################Look at loss and refugia in modelled distribution
sdm$TooWarm2080=NA
sdm$TooWarm2040=NA
sdm$TooWarmHIST=NA
sdm$TooWarm2080[which(sdm$S32_2080D>=13)]="TOO WARM"
sdm$TooWarm2080[which(sdm$S32_2080D>12 & sdm$S32_2080D<13)]="margCWH"
sdm$TooWarm2080[which(sdm$S32_2080D<=12)]="CWH"
sdm$TooWarmHIST[which(sdm$TEMP>=12)]="TOO WARM"
sdm$TooWarmHIST[which(sdm$TEMP>12 & sdm$TEMP<13)]="margCWH"
sdm$TooWarmHIST[which(sdm$TEMP<=12)]="CWH"
sdm$TooWarm2040[which(sdm$S30_2040D>=13)]="TOO WARM"
sdm$TooWarm2040[which(sdm$S30_2040D>12 & sdm$S30_2040D<13)]="margCWH"
sdm$TooWarm2040[which(sdm$S30_2040D<=12)]="CWH"
#Historical
sdm%>%filter(occ==1)%>%
group_by(TooWarmHIST)%>%
summarise(n=length(slope), p=length(slope)/61949) #
#Historical
sdm%>%filter(occ==1)%>%
group_by(TooWarmHIST)%>%
summarise(n=length(slope)) #
5915+468+735
#Historical
sdm%>%filter(occ==1)%>%
group_by(TooWarmHIST)%>%
summarise(n=length(slope), p=length(slope)/7118) #
#2040s
sdm%>%filter(occ==1)%>%
group_by(TooWarm2040)%>%
summarise(n=length(slope), p=length(slope)/7118)
#2080s
sdm%>%filter(occ==1)%>%
group_by(TooWarm2080)%>%
summarise(n=length(slope), p=length(slope)/7118)
#Loss Calculation
sdm%>%filter(occ==1 & TooWarmHIST!="TOO WARM")%>%
group_by(TooWarm2080)%>%
summarise(n=length(slope))
3116+1998+1536
#Loss Calculation
sdm%>%filter(occ==1 & TooWarmHIST!="TOO WARM")%>%
group_by(TooWarm2080)%>%
summarise(n=length(slope), p=length(slope)/6650)
#Loss Calculation (High End)
sdm%>%filter(occ==1 & TooWarmHIST=="CWH")%>%
group_by(TooWarm2080)%>%
summarise(n=length(slope))
3116+1263+1536
#Loss Calculation (High End)
sdm%>%filter(occ==1 & TooWarmHIST=="CWH")%>%
group_by(TooWarm2080)%>%
summarise(n=length(slope), p=length(slope)/5915)
0.214+0.260
